# BMAT Music Innovators


## App Details

...

# Proposed Stack

HCL 


# Top-level directory layout

    ðŸ“¦bmat-devops-task
        ðŸ“¦docs
            â”£ ðŸ“œBack_Office DevOps_Test_v2.pdf
            â”£ ðŸ“œBack_office_architecture.png
        ðŸ“¦live
            â”£ ðŸ“¦prod
            â”£ ðŸ“¦qa
            â”£ ðŸ“¦stage
        ðŸ“¦modules
            â”£ ðŸ“¦cache
            â”£ ðŸ“¦network
            â”£ ðŸ“¦services
        ðŸ“¦state_locking
            â”£ ðŸ“¦
            â”£ ðŸ“¦
            â”£ ðŸ“¦
        ðŸ“¦test
            â”£ ðŸ“¦state_locking
                 â”— ðŸ“œbackend.tf
                 â”— ðŸ“œmain.tf
                 â”— ðŸ“œoutput.tf
                 â”— ðŸ“œterraform.tfstate
                 â”— ðŸ“œvariables.tf
            â”£ ðŸ“œbackend.tf
            â”£ ðŸ“œinit-script.sh
            â”£ ðŸ“œmain.tf
            â”£ ðŸ“œoutput.tf
            â”£ ðŸ“œterraform.tfvars
            â”£ ðŸ“œvariables.tf
        â”£ ðŸ“œREADME.md


## The task can be found [here](https://github.com/adefemi171/bmat-devops-task/blob/main/docs/Back_Office%20DevOps_Test_v2.pdf)

## Infrastructure Architecture
![](docs/Back_office_architecture.png?raw=true)


## Folder structure

1. Docs: This folder contain documents like the task given and the architecture diagram

2. live: This folder contain three folders (prod, qa, stage) which serve as different environment for the task given.

3. modules: This folder contain two sub folders (services and cache) the service folder contain modules for vpc, autoscaling group, and security group. The cache folder creates a rdis elastic cache.

4 state_locking: This folder was use to create the S3 bucket and DynamoDB for state locking

5. test: While initializing the configuration, I ran into issues with Elastic IP as i was hitting the limit giving to me by AWS so I created a small test case to solve the task.

## Assumptions
I assumed that the metric I will be using to scale up the number of workers is the CPUUtilization and also I assumed the threshold as the number of job in queues.

1. For cost I used t2.micro instance type and also if there are no pending job in the queue, the instance is scaled down to zero

2. For reusability I have three environment which for further use case will contain different resources based onthe environment been used.

3. For security, I am using state locking and also each environment is been isolated from the other.

## Things to still work on
1. Hosting modules on a different repository and reaading fro there rather than reading locally
2. Set up Github Action for auto deployment

# How to setup project

### Clone the repository 

```
git clone https://github.com/adefemi171/bmat-devops-task.git
```
### Checking Out
The infrastructure is build on the ``` main ``` branch you will need to checkout to the app branch using:

```
git checkout main
```

### Change directory into either ofthe three environment

1. Create your backend for state locking can either be using S3 bucket and Dynamo DB Table or storing iit remotely on Terraform cloud

2. Create VPC

3. Create Security Group

4. Create Auto scaling group

All the above step can be done using the following command

To make sure your code is well formatted use

```
terraform fmt
```

To initialize the backend and download modules and provider from AWS and Hashicorp that is to initialize a working directory containing Terraform configuration file use

```
terraform init
```

To create an execution plan that is to check whether the execution plan for a set of changes matches your expectations without making any changes to real resources or to the state use

```
terraform plan
```

Toapply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by the previous command use

```
terraform apply
```

